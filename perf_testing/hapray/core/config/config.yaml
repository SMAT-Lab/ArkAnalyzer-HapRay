hiperf: # 性能采样相关
  enable: True
  duration: 30  # 默认采样时长（秒）
  output_path: "/data/local/tmp/perf.data"  # 性能数据在手机中的输出路径
  data_filename: "perf.data"  # 性能数据文件名
  db_filename: "perf.db"  # 数据库文件名
  event: raw-instruction-retired # 默认采集指令数，可配置为raw-cpu-cycles采集cycles
trace:
  enable: True
memory:
  enable: False  # Memory采集开关（通过命令行参数控制）
  max_stack_depth: 100  # Native Memory采集的最大调用栈深度
  interval_seconds: 2  # Level1 Memory采集的间隔时间（秒）
  snapshot_enable: False  # Snapshot采集开关
ui:
  capture_enable: True  # UI数据采集开关（截图和组件树）

# hilog日志分析配置
hilog:
  # 正则匹配规则，每个规则包含regex、groups和conditions
  # groups: 要提取的分组索引（从1开始，0表示整个匹配）
  # conditions: 条件过滤，支持两种格式：
  #   1. 数组格式：与groups一一对应，支持运算符：==, !=, <, >, <=, >=
  #   2. 表达式字符串：支持分组值的数学运算和比较（包含$符号时自动识别为表达式）
  #      表达式语法：
  #      - $1, $2, $3... 表示第1、2、3...个提取的分组值（对应groups配置中的位置）
  #      - 支持数学运算：+, -, *, /, %
  #      - 支持比较运算符：==, !=, <, >, <=, >=
  #      - 支持括号：()
  #      - 支持多个表达式（AND逻辑）：用逗号或 && 分隔，所有表达式都满足才匹配
  #   示例：
  #     - conditions: ["!=4"]  # 数组格式：分组1 != 4
  #     - conditions: "$1 * $2 > $3 * $4"  # 表达式格式：分组1和2的乘积大于分组3和4的乘积
  #     - conditions: "$1*$2>0,$3*$4>512*512"  # 多个表达式：分组1*2>0 且 分组3*4>512*512
  patterns:
    # 示例规则1：使用conditions数组格式（简单条件）
    - name: "图片解码没有使用DMA(memType!=4)"  # 规则名称
      regex: "CreatePixelMap success,.*memType\\s*:\\s*(\\d+),\\s*cost\\s+\\d+\\s+us"  # 正则表达式，带分组
      # regex: "CreatePixelMapExtended success,.*memoryType\\s*:\\s*(\\d+),\\s*cost\\s+\\d+\\s+us"  # 正则表达式，带分组
      groups: [1]  # 要提取的分组索引（从1开始，0表示整个匹配）
      conditions: "$1!=4"  # 条件过滤，与groups一一对应，满足条件才计数
    
    # 示例规则2：使用conditions表达式格式（复杂计算）
    # - name: "图片解码宽高乘积比较"
    #   regex: "CreatePixelMap.*width\\s*:\\s*(\\d+).*height\\s*:\\s*(\\d+).*width2\\s*:\\s*(\\d+).*height2\\s*:\\s*(\\d+)"
    #   groups: [1, 2, 3, 4]  # 提取4个分组：width1, height1, width2, height2
    #   conditions: "$1 * $2 > $3 * $4"  # 第一个宽高乘积大于第二个宽高乘积
    
    # 示例规则3：使用多个表达式（AND逻辑）
    # - name: "多条件匹配示例"
    #   regex: "value1\\s*:\\s*(\\d+).*value2\\s*:\\s*(\\d+).*value3\\s*:\\s*(\\d+).*value4\\s*:\\s*(\\d+)"
    #   groups: [1, 2, 3, 4]  # 提取4个分组
    #   conditions: "$1*$2>0,$3*$4>512"  # 分组1*2>0 且 分组3*4>512（使用逗号分隔）
    #   # 或者使用 && 分隔：conditions: "$1*$2>0 && $3*$4>512"
    
    # 规则：CreatePixelMapExtended 图片解码尺寸检查
    - name: "CreatePixelMapExtended尺寸检查"
      regex: "CreatePixelMap success.*dSize\\s*:\\s*\\((\\d+),\\s*(\\d+)\\).*srcSize\\s*:\\s*\\((\\d+),\\s*(\\d+)\\)"
      # regex: "CreatePixelMapExtended success.*desiredSize\\s*:\\s*\\((\\d+),\\s*(\\d+)\\).*imageSize\\s*:\\s*\\((\\d+),\\s*(\\d+)\\)"
      groups: [1, 2, 3, 4]  # 提取4个分组：desiredSize的宽高，imageSize的宽高
      conditions: "$1*$2>0,$3*$4>512*512"  # desiredSize面积>0 且 imageSize面积>512*512

# 帧分析配置
frame_analysis:
  # 进行深度分析的TOP N卡顿帧数量
  # 建议值: 5-20，根据性能需求调整
  top_n_analysis: 10

# 调用链精化过滤配置
callchain_filter:
  # 文件和符号绑定排除规则（文件和符号必须同时匹配才排除）
  # 使用YAML锚点避免重复定义符号列表
  exclude_rules:
    # 匹配包含 libc 或 libc++ 的 .so 文件（包含关系）
    '.*libc(\+\+)?\.so.*': 
      - '.*'
    # ld-musl-aarch64.so 
    '.*ld-musl-aarch64\.so.*': 
      - '.*'
    # libc++_shared.so 
    '.*libc\+\+_shared\.so.*': 
      - '.*'
    # /system/lib64/chipset-pub-sdk/libutils.z.so
    '.*/system/lib64/chipset-pub-sdk/libutils\.z\.so':
      - 'OHOS::Parcel::Parcel()'




